<!DOCTYPE html>
<html>
<head>
  <title>PCAN MONSTER WAR - QR Scan</title>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <style>
    body { font-family: 'Courier New', monospace; text-align: center; }
    .monster-card { border: 2px solid #333; padding: 20px; margin-top: 20px; display: inline-block; }
  </style>
</head>
<body>
  <h1>üéÆ PCAN MONSTER WAR üéÆ</h1>
  <div id="qr-reader" style="width: 300px; margin: auto;"></div>
  <div id="result" class="monster-card" style="display: none;"></div>
  <div id="battle-scene" style="display: flex; justify-content: space-between; align-items: center; padding: 20px;">
  <div id="player-side" style="text-align: center;"></div>
  <div id="battle-log" style="flex: 1; padding: 10px; font-family: monospace;"></div>
  <div id="enemy-side" style="text-align: center;"></div>
</div>


  <script>
    const monsterDatabase = {
"QR001": {name: "Phoenix", hp: 70, mp: 80, atk: 22,image: "https://raw.githubusercontent.com/PNS004/GameTest/main/1.jpg" 
},
"QR002": { name: "RiverDragon", hp: 120, mp: 30, atk: 28,image: "https://raw.githubusercontent.com/PNS004/GameTest/main/2.jpg"
},
"QR003": {name: "EarthDragon", hp: 110, mp: 40, atk: 26,image: "https://raw.githubusercontent.com/PNS004/GameTest/main/3.jpg"
},
"QR004": {name: "Werewolf", hp: 110, mp: 40, atk: 24,image: "https://raw.githubusercontent.com/PNS004/GameTest/main/4.jpg"
},
"QR005": {name: "Cerberus", hp: 100, mp: 50, atk: 25,image: "https://raw.githubusercontent.com/PNS004/GameTest/main/5.jpg"
},
"QR006": {name: "LeafBeast", hp: 120, mp: 30, atk: 20,image: "https://raw.githubusercontent.com/PNS004/GameTest/main/6.jpg"
},
"QR007": {name: "Griffin", hp: 130, mp: 20, atk: 27,image: "https://raw.githubusercontent.com/PNS004/GameTest/main/7.jpg"
},
"QR008": {name: "Firewolf", hp: 90, mp: 60, atk: 23,image: "https://raw.githubusercontent.com/PNS004/GameTest/main/8.jpg"
},
"QR009": {name: "Reaper", hp: 50, mp: 100, atk: 35,image: "https://raw.githubusercontent.com/PNS004/GameTest/main/9.jpg"
},
"QR010": {name: "ShadowBeast", hp: 150, mp: 100, atk: 30,image: "https://raw.githubusercontent.com/PNS004/GameTest/main/10.jpg"
}


    };

    function showMonster(data) {
  const monsterKey = data.toUpperCase();
  const monster = monsterDatabase[monsterKey];
  const resultDiv = document.getElementById("result");

  if (monster) {
    resultDiv.innerHTML = `
  <h2>üéâ You Got: ${monster.name}!</h2>
  <img src="${monster.image}" width="150"><br>
  HP: ${monster.hp} | MP: ${monster.mp} | ATK: ${monster.atk}<br>
  <button onclick="startBattle('${monsterKey}')">‚öîÔ∏è ‡∏™‡∏π‡πâ‡∏Å‡∏±‡∏ö AI</button>
  <button onclick="restartScanner()">üîÑ ‡∏™‡πÅ‡∏Å‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
`;

    saveMonster(monsterKey); // üü© ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ
  } else {
    resultDiv.innerHTML = `<h2>‚ùå QR ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å</h2>`;
  }
  resultDiv.style.display = "block";
}


    const qrCodeSuccessCallback = (decodedText) => {
        console.log("QR scanned:", decodedText);
      html5QrcodeScanner.clear();
      showMonster(decodedText.trim());
    };

    const html5QrcodeScanner = new Html5QrcodeScanner(
      "qr-reader", { fps: 10, qrbox: 250 }
    );
    html5QrcodeScanner.render(qrCodeSuccessCallback);

    function saveMonster(monsterKey) {
  let collection = JSON.parse(localStorage.getItem("monsterCollection")) || [];
  if (!collection.includes(monsterKey)) {
    collection.push(monsterKey);
    localStorage.setItem("monsterCollection", JSON.stringify(collection));
  }
}
function showMonster(data) {
  const monsterKey = data.toUpperCase();
  const monster = monsterDatabase[monsterKey];
  const resultDiv = document.getElementById("result");

  if (monster) {
    resultDiv.innerHTML = `
      <h2>üéâ You Got: ${monster.name}!</h2>
      <img src="${monster.image}" width="150"><br>
      <strong>HP:</strong> ${monster.hp} | <strong>MP:</strong> ${monster.mp}
      <button onclick="startBattle('${monsterKey}')">‚öîÔ∏è ‡∏™‡∏π‡πâ‡∏Å‡∏±‡∏ö AI</button>
    `;
    saveMonster(monsterKey); // üü© ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ
  } else {
    resultDiv.innerHTML = `<h2>‚ùå QR ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å</h2>`;
  }
  resultDiv.style.display = "block";
}
function saveMonster(monsterKey) {
  let collection = JSON.parse(localStorage.getItem("monsterCollection")) || [];
  if (!collection.includes(monsterKey)) {
    collection.push(monsterKey);
    localStorage.setItem("monsterCollection", JSON.stringify(collection));
  }
}
function showCollection() {
  const container = document.getElementById("collection");
  container.innerHTML = "<h2>üßæ Monster Collection</h2>";

  let collection = JSON.parse(localStorage.getItem("monsterCollection")) || [];

  if (collection.length === 0) {
    container.innerHTML += "<p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏•‡∏¢!</p>";
    return;
  }

 collection.forEach(key => {
  const mon = monsterDatabase[key];
  if (mon) {
    container.innerHTML += `
      <div style="border:1px solid #aaa; padding:10px; margin:5px;">
        <strong>${mon.name}</strong><br>
        <img src="${mon.image}" width="100"><br>
        HP: ${mon.hp} | MP: ${mon.mp}<br>
        <button onclick="startBattle('${key}')">‚öîÔ∏è ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏™‡∏π‡πâ!</button>
        <button onclick="deleteOne('${key}')">üóëÔ∏è ‡∏•‡∏ö</button>
      </div>
    `;
  }
});

}
function deleteOne(monsterKey) {
  let collection = JSON.parse(localStorage.getItem("monsterCollection")) || [];
  collection = collection.filter(key => key !== monsterKey);
  localStorage.setItem("monsterCollection", JSON.stringify(collection));
  showCollection(); // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡∏Å‡∏ä‡∏±‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
}

function clearCollection() {
  const confirmDelete = confirm("‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ô‡∏∞‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏•‡∏ö‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡∏Å‡∏ä‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?");
  if (confirmDelete) {
    localStorage.removeItem("monsterCollection");
    alert("‡∏•‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!");
    document.getElementById("collection").innerHTML = "";
  }
}

function restartScanner() {
  document.getElementById("result").style.display = "none";
  html5QrcodeScanner.render(qrCodeSuccessCallback);
}

function startBattle(monsterKey) {
  if (!monsterDatabase[monsterKey]) {
    alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
    return;
  }

  const player = {...monsterDatabase[monsterKey]};
  const enemy = {
    name: "Shadow Beast",
    hp: 70
    ,
    mp: 50,
    atk: 20,
    image: "https://raw.githubusercontent.com/PNS004/GameTest/main/10.jpg"
  };
//---------------------------------------------------------------------
let log = [];

  // ‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏≤‡∏û‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢/‡∏Ç‡∏ß‡∏≤
  document.getElementById("player-side").innerHTML = `
    <h3>${player.name}</h3>
    <img src="${player.image}" width="150"><br>
    HP: <span id="player-hp">${player.hp}</span>
  `;
  document.getElementById("enemy-side").innerHTML = `
    <h3>${enemy.name}</h3>
    <img src="${enemy.image}" width="150"><br>
    HP: <span id="enemy-hp">${enemy.hp}</span>
  `;

  const logDiv = document.getElementById("battle-log");
  logDiv.innerHTML = `<h3>‚öîÔ∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ!</h3><hr>`;

  
 const interval = setInterval(() => {
    if (player.hp <= 0 || enemy.hp <= 0) {
      clearInterval(interval);
      const result = player.hp > 0 ? "üèÜ ‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏ô‡∏∞!" : "üíÄ ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏û‡πâ...";
      logDiv.innerHTML += `<p><strong>${result}</strong></p>`;
      logDiv.innerHTML += `<button onclick="restartScanner()">üîÑ ‡∏™‡πÅ‡∏Å‡∏ô‡πÉ‡∏´‡∏°‡πà</button>`;
      return;
    }

    const playerDmg = Math.floor(Math.random() * player.atk);
    const enemyDmg = Math.floor(Math.random() * enemy.atk);

    enemy.hp -= playerDmg;
    logDiv.innerHTML += `<p>${player.name} ‡πÇ‡∏à‡∏°‡∏ï‡∏µ ${enemy.name} -${playerDmg} HP</p>`;
    document.getElementById("enemy-hp").textContent = Math.max(enemy.hp, 0);

    if (enemy.hp <= 0) return;

    player.hp -= enemyDmg;
    logDiv.innerHTML += `<p>${enemy.name} ‡πÇ‡∏à‡∏°‡∏ï‡∏µ ${player.name} -${enemyDmg} HP</p>`;
    document.getElementById("player-hp").textContent = Math.max(player.hp, 0);
  }, 1000);
}
  log.push(`üí• ‡∏™‡∏£‡∏∏‡∏õ: ${player.name} HP: ${player.hp}, ${enemy.name} HP: ${enemy.hp}`);

  const resultDiv = document.getElementById("result");
  resultDiv.innerHTML = `
    <h2>‚öîÔ∏è Battle Result</h2>
    <pre>${log.join("\n")}</pre>
    <button onclick="restartScanner()">üîÑ ‡∏™‡πÅ‡∏Å‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
  `;


  </script>
 
  <button onclick="showCollection()">üìñ ‡∏î‡∏π‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡πÑ‡∏î‡πâ</button>
<div id="collection" style="margin-top: 20px;"></div>

<button onclick="clearCollection()">üóëÔ∏è ‡∏•‡∏ö‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡∏Å‡∏ä‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>

</body>
</html>
